# üìò PSB Student Platform --- API Contract (Backend Spec)

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç **–ø–æ–ª–Ω—ã–π REST API**, –∫–æ—Ç–æ—Ä—ã–π –æ–∂–∏–¥–∞–µ—Ç frontend
–ø—Ä–æ–µ–∫—Ç–∞ `PSB-main` (React).\
–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –Ω–∏–∂–µ --- –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã.

## –û–±—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞

-   –í—Å–µ –æ—Ç–≤–µ—Ç—ã --- `application/json`.

-   –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è: `Authorization: Bearer <accessToken>`.

-   –û—à–∏–±–∫–∏:

    ``` json
    { "error": "Message" }
    ```

------------------------------------------------------------------------

# 0. AUTH & TOKENS

## POST /api/auth/login

–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

### Request

``` json
{
  "email": "student@psb.ru",
  "password": "password123"
}
```

### Response

``` json
{
  "accessToken": "jwt-token",
  "refreshToken": "refresh-token",
  "user": {
    "id": "stu_1",
    "name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
    "email": "student@psb.ru",
    "role": "student"
  }
}
```

------------------------------------------------------------------------

## POST /api/auth/signup

–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

### Request

``` json
{
  "name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
  "email": "student@psb.ru",
  "password": "password123"
}
```

### Response

*—Ç–∞–∫–æ–π –∂–µ –∫–∞–∫ login*.

------------------------------------------------------------------------

## GET /api/auth/me

–í–µ—Ä–Ω—É—Ç—å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

### Response

``` json
{
  "id": "stu_1",
  "name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
  "email": "student@psb.ru",
  "role": "student"
}
```

------------------------------------------------------------------------

## POST /api/auth/refresh

–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞.

### Request

``` json
{
  "refreshToken": "refresh-token"
}
```

### Response

``` json
{
  "accessToken": "new-token",
  "refreshToken": "new-refresh"
}
```

------------------------------------------------------------------------

# 1. PROFILE

## GET /api/profile

–ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è —Å—Ç—É–¥–µ–Ω—Ç–∞.

### Response

``` json
{
  "id": "stu_1",
  "firstName": "–ò–≤–∞–Ω",
  "lastName": "–ò–≤–∞–Ω–æ–≤",
  "email": "ivan@psb.ru",
  "phone": "+7 (999) 123-45-67",
  "group": "–ò–ö–ë–û-01-25",
  "university": "–ú–ò–†–≠–ê",
  "enrolledSince": 2024,
  "completedCourses": 3,
  "timezone": "Europe/Moscow"
}
```

------------------------------------------------------------------------

## PUT /api/profile

–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è.

### Request

``` json
{
  "firstName": "–ò–≤–∞–Ω",
  "lastName": "–ò–≤–∞–Ω–æ–≤",
  "email": "ivan@psb.ru",
  "phone": "+79991234567",
  "group": "–ò–ö–ë–û-01-25",
  "university": "–ú–ò–†–≠–ê",
  "timezone": "Europe/Moscow"
}
```

### Response

*–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å*.

------------------------------------------------------------------------

## GET /api/profile/notifications-settings

### Response

``` json
{
  "emailAssignments": true,
  "emailTests": true,
  "emailNews": false,
  "inAppReminders": true
}
```

------------------------------------------------------------------------

## PUT /api/profile/notifications-settings

### Request

``` json
{
  "emailAssignments": true,
  "emailTests": false,
  "emailNews": false,
  "inAppReminders": true
}
```

### Response

``` json
{ "success": true }
```

------------------------------------------------------------------------

## POST /api/profile/change-password

### Request

``` json
{
  "currentPassword": "oldPass",
  "newPassword": "newPass"
}
```

### Response

``` json
{ "success": true }
```

------------------------------------------------------------------------

# 2. COURSES

## GET /api/student/courses

–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: `?status=active|completed|all`.

### Response

``` json
[
  {
    "id": "course_1",
    "title": "–û—Å–Ω–æ–≤—ã —Ñ–∏–Ω—Ç–µ—Ö-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏",
    "description": "–ò–∑—É—á–∏—Ç–µ –æ—Å–Ω–æ–≤—ã —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π",
    "instructor": "–ê–Ω–Ω–∞ –°–º–∏—Ä–Ω–æ–≤–∞",
    "progressPercent": 65,
    "status": "in_progress",
    "nextDeadline": "2024-12-23T20:59:00Z",
    "badges": ["–•–∞–∫–∞—Ç–æ–Ω –ü–°–ë"]
  }
]
```

------------------------------------------------------------------------

## GET /api/courses/:courseId/overview

### Response

``` json
{
  "id": "course_1",
  "title": "–û—Å–Ω–æ–≤—ã —Ñ–∏–Ω—Ç–µ—Ö-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏",
  "description": "–ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫—É—Ä—Å–∞...",
  "instructor": { "id": "teacher_1", "name": "–ê–Ω–Ω–∞ –°–º–∏—Ä–Ω–æ–≤–∞" },
  "progressPercent": 65,
  "modules": [
    {
      "id": "mod_1",
      "title": "–í–≤–µ–¥–µ–Ω–∏–µ –≤ —Ñ–∏–Ω—Ç–µ—Ö",
      "progressPercent": 100,
      "lessons": 5,
      "completedLessons": 5,
      "status": "completed"
    }
  ],
  "upcomingDeadlines": [
    {
      "type": "assignment",
      "id": "ass_3",
      "title": "–î–ó 3.2",
      "deadline": "2024-12-23T20:59:00Z"
    }
  ]
}
```

------------------------------------------------------------------------

# 3. MATERIALS

## GET /api/courses/:courseId/materials

### Response

``` json
{
  "modules": [
    {
      "id": "mod_1",
      "title": "–í–≤–µ–¥–µ–Ω–∏–µ –≤ —Ñ–∏–Ω—Ç–µ—Ö",
      "items": [
        {
          "id": "mat_1",
          "type": "video",
          "title": "–ó–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å —Ñ–∏–Ω—Ç–µ—Ö–æ–º",
          "durationMinutes": 12,
          "status": "completed"
        }
      ]
    }
  ]
}
```

------------------------------------------------------------------------

## GET /api/materials/:materialId

### Response (example: video)

``` json
{
  "id": "mat_1",
  "courseId": "course_1",
  "moduleId": "mod_1",
  "type": "video",
  "title": "–û—Å–Ω–æ–≤—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è",
  "description": "–†–∞–∑–±–æ—Ä –±–∞–∑–æ–≤—ã—Ö –ø–æ–Ω—è—Ç–∏–π —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è...",
  "videoUrl": "https://cdn.psb.ru/video.mp4",
  "transcript": "–¢–µ–∫—Å—Ç–æ–≤–∞—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞...",
  "status": "in_progress",
  "viewProgressPercent": 60,
  "relatedAssignments": [
    { "id": "ass_5", "title": "–î–ó: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å" }
  ]
}
```

------------------------------------------------------------------------

## POST /api/materials/:materialId/progress

### Request

``` json
{
  "viewProgressPercent": 100,
  "completed": true
}
```

### Response

``` json
{ "success": true }
```

------------------------------------------------------------------------

# 4. ASSIGNMENTS

## GET /api/courses/:courseId/assignments

### Response

``` json
[
  {
    "id": "ass_1",
    "title": "–î–ó 3.2",
    "module": "–ú–æ–¥—É–ª—å 3",
    "deadline": "2024-12-23T20:59:00Z",
    "status": "submitted",
    "grade": null,
    "hasNewComments": true
  }
]
```

------------------------------------------------------------------------

## GET /api/assignments/:assignmentId

### Response

``` json
{
  "id": "ass_1",
  "courseId": "course_1",
  "title": "–î–ó 3.2",
  "description": "–†–µ–∞–ª–∏–∑—É–π—Ç–µ REST API...",
  "module": "–ú–æ–¥—É–ª—å 3",
  "deadline": "2024-12-23T20:59:00Z",
  "status": "submitted",
  "grade": null,
  "maxGrade": 10,
  "teacherFiles": [
    { "id": "file_t1", "name": "spec.pdf", "url": "https://cdn/spec.pdf" }
  ],
  "criteria": [
    { "id": "crit_1", "title": "–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å API", "max": 4 }
  ]
}
```

------------------------------------------------------------------------

## GET /api/assignments/:assignmentId/submissions

### Response

``` json
[
  {
    "id": "sub_1",
    "createdAt": "2024-12-20T18:30:00Z",
    "status": "graded",
    "grade": 7,
    "commentFromStudent": "–ü–µ—Ä–≤–∞—è –≤–µ—Ä—Å–∏—è",
    "files": [
      { "id": "file_1", "name": "hw_v1.zip", "url": "https://cdn/h1.zip" }
    ],
    "teacherComments": [
      {
        "id": "tc_1",
        "author": { "id": "teacher_1", "name": "–ê–Ω–Ω–∞ –°–º–∏—Ä–Ω–æ–≤–∞" },
        "createdAt": "2024-12-21T09:10:00Z",
        "text": "–ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫."
      }
    ]
  }
]
```

------------------------------------------------------------------------

## POST /api/assignments/:assignmentId/submissions

Multipart form-data.

### Fields

-   `comment` --- string\
-   `files[]` --- files

### Response

``` json
{
  "id": "sub_2",
  "createdAt": "2024-12-22T19:00:00Z",
  "status": "submitted",
  "files": [],
  "teacherComments": []
}
```

------------------------------------------------------------------------

# 5. TESTS

## GET /api/courses/:courseId/tests

### Response

``` json
[
  {
    "id": "test_1",
    "title": "–¢–µ—Å—Ç –ø–æ –º–æ–¥—É–ª—é 3",
    "module": "–ú–æ–¥—É–ª—å 3",
    "deadline": "2024-12-25T20:59:00Z",
    "status": "not_started",
    "attemptsUsed": 0,
    "attemptsLimit": 3,
    "bestScorePercent": null
  }
]
```

------------------------------------------------------------------------

## GET /api/tests/:testId

### Response

``` json
{
  "id": "test_1",
  "title": "–¢–µ—Å—Ç –ø–æ –º–æ–¥—É–ª—é 3",
  "timeLimitMinutes": 20,
  "questions": [
    {
      "id": "q1",
      "type": "single_choice",
      "text": "–ß—Ç–æ —Ç–∞–∫–æ–µ —Ç–æ–∫–µ–Ω?",
      "options": [
        { "id": "o1", "text": "..." },
        { "id": "o2", "text": "..." }
      ]
    }
  ]
}
```

------------------------------------------------------------------------

## POST /api/tests/:testId/attempts

### Request

``` json
{
  "answers": [
    { "questionId": "q1", "selectedOptionIds": ["o1"] }
  ]
}
```

### Response

``` json
{
  "attemptId": "att_1",
  "scorePercent": 86,
  "passed": true,
  "details": [
    { "questionId": "q1", "correct": true }
  ]
}
```

------------------------------------------------------------------------

# 6. CHAT

## GET /api/courses/:courseId/chat/channels

### Response

``` json
[
  { "id": "ch_general", "name": "–û–±—â–∏–π —á–∞—Ç", "unreadCount": 5 },
  { "id": "ch_homework", "name": "–í–æ–ø—Ä–æ—Å—ã –ø–æ –î–ó", "unreadCount": 1 }
]
```

------------------------------------------------------------------------

## GET /api/chat/channels/:channelId/messages?cursor=

### Response

``` json
{
  "messages": [
    {
      "id": "msg_1",
      "author": { "id": "teacher_1", "name": "–ê–Ω–Ω–∞", "role": "teacher" },
      "text": "–ù–µ –∑–∞–±—É–¥—å—Ç–µ —Å–¥–∞—Ç—å –î–ó",
      "createdAt": "2024-12-20T09:00:00Z"
    }
  ],
  "nextCursor": null
}
```

------------------------------------------------------------------------

## POST /api/chat/channels/:channelId/messages

### Request

``` json
{"text": "–î–æ–±—Ä—ã–π –¥–µ–Ω—å!"}
```

### Response

``` json
{
  "id": "msg_10",
  "text": "–î–æ–±—Ä—ã–π –¥–µ–Ω—å!",
  "createdAt": "2024-12-22T10:00:00Z"
}
```

------------------------------------------------------------------------

# 7. GRADES

## GET /api/courses/:courseId/grades

### Response

``` json
{
  "courseId": "course_1",
  "totalScore": 37,
  "maxTotalScore": 50,
  "items": [
    {
      "id": "ass_1",
      "type": "assignment",
      "title": "–î–ó 3.2",
      "module": "–ú–æ–¥—É–ª—å 3",
      "score": 7,
      "maxScore": 10,
      "status": "graded"
    }
  ]
}
```

------------------------------------------------------------------------

# 8. CALENDAR

## GET /api/calendar?from=&to=

### Response

``` json
[
  {
    "id": "ev_1",
    "date": "2024-12-23",
    "title": "–î–ó 3.2: API",
    "type": "assignment",
    "course": "–û—Å–Ω–æ–≤—ã —Ñ–∏–Ω—Ç–µ—Ö-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏",
    "entityType": "assignment",
    "entityId": "ass_1"
  }
]
```

------------------------------------------------------------------------

# 9. NOTIFICATIONS

## GET /api/notifications

### Response

``` json
[
  {
    "id": "n1",
    "type": "assignment_comment",
    "title": "–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –î–ó",
    "body": "–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å –æ—Å—Ç–∞–≤–∏–ª –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π",
    "entityType": "assignment",
    "entityId": "ass_1",
    "courseId": "course_1",
    "createdAt": "2024-12-21T10:01:00Z",
    "read": false
  }
]
```

------------------------------------------------------------------------

## POST /api/notifications/:id/read

### Request

``` json
{ "read": true }
```

### Response

``` json
{ "success": true }
```

------------------------------------------------------------------------

# ‚úî –ò—Ç–æ–≥

–≠—Ç–æ **–ø–æ–ª–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è API**, –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É –¥–ª—è —Ä–∞–±–æ—Ç—ã
–ø–ª–∞—Ç—Ñ–æ—Ä–º—ã PSB Student Platform.
